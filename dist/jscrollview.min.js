var JScrollView=function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.985;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)*(1-Math.pow(e,t))/(1-e)}function a(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(e<t){return t-o(t-e)/i}if(n<e){return n+o(e-n)/i}return e}function s(t){return t+"px"}function l(t,e){if("string"==typeof e&&"%"==e.charAt(e.length-1)){var n=e.substring(0,e.length-1);return t*Number(n)/100}return Number(e)}Object.defineProperty(e,"__esModule",{value:!0});var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(){function t(e,n){var o=this;if(i(this,t),this._baseContentSize=null,this._marginInPixel=null,this._contentAdjust={x:0,y:0},this._contentOffset=h({x:0,y:0},n.contentOffset),this._contentMargin=h({top:"auto",left:"auto",bottom:"auto",right:"auto"},n.contentMargin),this._zoomScale=n.zoomScale||1,this._wheelZoomScale=n.wheelZoomScale||1.1,this._minimumZoomScale=n.minimumZoomScale||.5,this._maximumZoomScale=n.maximumZoomScale||5.5,this._checkDoubleTapFailure=n.checkDoubleTapFailure||!1,this._watchResize=n.watchResize||!0,this._scrollBounce=n.scrollBounce||"auto","string"==typeof e&&null==(e=document.getElementById(e)||document.querySelector(e)))throw new Error("Missing container: "+e);e.style.overflow="hidden";var a=document.createElement("div");a.id="__jscrollview_root_",a.style.position="absolute",a.style.left=0,a.style.top=0,a.style.transformOrigin="top left";for(var s=e.children,l=0;l<s.length;l++)a.appendChild(s[l]);e.appendChild(a),this._contentRoot=a,this._container=e,this._installGestureRecognizer(e,n),this._resizeListener=function(t){o._containerWidth=o._container.clientWidth,o._containerHeight=o._container.clientHeight,o.invalidateSize(),o.setNeedsLayout()},this._watchResize&&window.addEventListener("resize",this._resizeListener),this._resizeListener()}return r(t,[{key:"_installGestureRecognizer",value:function(t,e){var n=this,i=new Hammer.Manager(t,{}),o=new Hammer.Tap({event:"doubletap",taps:2,threshold:5}),a=new Hammer.Tap({event:"singletap"}),s=new Hammer.Pan({direction:Hammer.DIRECTION_ALL}),l=new Hammer.Pinch;i.add([o,a,s,l]),o.recognizeWith(a),e.checkDoubleTapFailure&&a.requireFailure(o),l.recognizeWith(s),i.on("singletap",function(t){n._handleSingleTap(t),t.preventDefault()}),i.on("doubletap",function(t){n._handleDoubleTap(t),t.preventDefault()}),i.on("panstart panmove panend pancancel",function(t){n._handlePan(t),t.preventDefault()}),i.on("pinchstart pinchmove pinchend pinchcancel",function(t){n._handlePinch(t),t.preventDefault()}),this._mouseWheelListener=function(t){n._handleMouseWheel(t),t.preventDefault()},t.addEventListener("mousewheel",this._mouseWheelListener),this._gestureDelegate={},this._mc=i}},{key:"getContainer",value:function(){return this._container}},{key:"getHammer",value:function(){return this._mc}},{key:"destroy",value:function(){this._container.removeEventListener("mousewheel",this._mouseWheelListener),window.removeEventListener("resize",this._resizeListener),this._mc.destroy(),this._container=null}},{key:"setGestureDelegate",value:function(t){this._gestureDelegate=t||{}}},{key:"setContent",value:function(t){"function"==typeof t.toHtmlElement&&(t=t.toHtmlElement()),this._contentRoot.innerHTML="",this._contentRoot.appendChild(t),this.invalidateSize(),this.setNeedsLayout()}},{key:"invalidateSize",value:function(){this._baseContentSize=null,this._marginInPixel=null}},{key:"contentMargin",value:function(t){if(null==t)return{top:this._contentMargin.top,left:this._contentMargin.left,bottom:this._contentMargin.bottom,right:this._contentMargin.right};null!=t.top&&(this._contentMargin.top=t.top),null!=t.left&&(this._contentMargin.left=t.left),null!=t.bottom&&(this._contentMargin.bottom=t.bottom),null!=t.right&&(this._contentMargin.right=t.right)}},{key:"contentOffset",value:function(t){if(null==t)return{x:this._contentOffset.x,y:this._contentOffset.y};null!=t.x&&(this._contentOffset.x=t.x),null!=t.y&&(this._contentOffset.y=t.y),this.setNeedsLayout()}},{key:"setContentOffset",value:function(t,e){null!=t.x&&(this._contentOffset.x=t.x),null!=t.y&&(this._contentOffset.y=t.y),this.layout(e?.25:0)}},{key:"wheelZoomScale",value:function(t){if(null==t)return this._wheelZoomScale;this._wheelZoomScale=t}},{key:"zoomScale",value:function(t){if(null==t)return this._zoomScale;this._zoomScale=t,this.setNeedsLayout()}},{key:"setZoomScale",value:function(t,e){this._zoomScale=t,this.layout(e?.25:0)}},{key:"setContentOffsetAndZoomScale",value:function(t,e,n){null!=t.x&&(this._contentOffset.x=t.x),null!=t.y&&(this._contentOffset.y=t.y),this._zoomScale=e,this.layout(n?.25:0)}},{key:"minimumZoomScale",value:function(t){if(null==t)return this._minimumZoomScale;this._minimumZoomScale=t}},{key:"maximumZoomScale",value:function(t){if(null==t)return this._maximumZoomScale;this._maximumZoomScale=t}},{key:"setNeedsLayout",value:function(){var t=this;null==this._layoutTimerId&&(this._layoutTimerId=setTimeout(function(){t.layout(),t._layoutTimerId=null},0))}},{key:"layout",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0==this._containterWidth||0==this._containerHeight)return void console.log("Fatal Error: invalid container size. "+this._containerWidth+"x"+this._containerHeight);0<t?(null!=this._layoutTimerId&&(clearTimeout(this._layoutTimerId),this._layoutTimerId=null),this._contentRoot.style.transition=["transform "+t+"s"].join(",")):this._contentRoot.style.transition="none";var e=this._calcContentAdjust(this._zoomScale),n=s(e.x-this._contentOffset.x),i=s(e.y-this._contentOffset.y),o=["translate("+n+","+i+")","scale("+this._zoomScale.toFixed(4)+")"].join(" ");this._contentRoot.style.transform=o}},{key:"getContentSize",value:function(){return this._calcContentSize(this._zoomScale)}},{key:"_calcMarginInPixel",value:function(){return null==this._marginInPixel&&(this._marginInPixel={top:l(this._containerHeight,this._contentMargin.top),left:l(this._containerWidth,this._contentMargin.left),bottom:l(this._containerHeight,this._contentMargin.bottom),right:l(this._containerWidth,this._contentMargin.right)}),this._marginInPixel}},{key:"_calcContentAdjust",value:function(t){var e=this._calcContentSize(t),n=function(e,n,i,o){var a=void 0;return isNaN(i)&&!isNaN(o)?a=(e-n-o)/t:!isNaN(i)&&isNaN(o)?a=i/t:isNaN(i)||isNaN(o)?a=Math.max(0,(e-n)/2):(a=(e-n-o)/t,a=Math.max(a,i/t)),a},i=this._calcMarginInPixel();return{x:n(this._containerWidth,e.width,i.left,i.right),y:n(this._containerHeight,e.height,i.top,i.bottom)}}},{key:"_calcContentSize",value:function(t){var e=this._calcBaseContentSize();return{width:e.width*t,height:e.height*t}}},{key:"_calcBaseContentSize",value:function(){if(null==this._baseContentSize){for(var t=0,e=0,n=this._contentRoot.children,i=0;i<n.length;i++){var o=n[i];t=Math.max(t,o.offsetLeft+o.offsetWidth),e=Math.max(e,o.offsetTop+o.offsetHeight)}this._baseContentSize={width:t,height:e}}return{width:this._baseContentSize.width,height:this._baseContentSize.height}}},{key:"_getContainerOffset",value:function(){for(var t=this._container,e=0,n=0;null!=t;)e+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;return{x:e,y:n}}},{key:"globalToContainer",value:function(t){var e=this._getContainerOffset();return{x:t.x-e.x,y:t.y-e.y}}},{key:"globalToContent",value:function(t){t=this.globalToContainer(t);var e=this._calcContentAdjust(this._zoomScale);return{x:(t.x+this._contentOffset.x-e.x)/this._zoomScale,y:(t.y+this._contentOffset.y-e.y)/this._zoomScale}}},{key:"_handleSingleTap",value:function(t){null!=this._gestureDelegate.handleSingleTap&&this._gestureDelegate.handleSingleTap(t)}},{key:"_handleDoubleTap",value:function(t){if(null==this._gestureDelegate.handleDoubleTap||!this._gestureDelegate.handleDoubleTap(t))if(1!=this._zoomScale)this.setContentOffsetAndZoomScale({x:0,y:0},1,!0);else{var e=this.globalToContent(t.center);this.zoomToPoint(e,4,!0)}}},{key:"_getMinimumContentOffset",value:function(t){return{x:0,y:0}}},{key:"_getMaximumContentOffset",value:function(t){var e=this._calcContentSize(t||this._zoomScale),n=this._calcContentAdjust(t||this._zoomScale);return{x:Math.max(0,e.width-this._containerWidth+n.x),y:Math.max(0,e.height-this._containerHeight+n.y)}}},{key:"_limitContentOffset",value:function(t,e,n){n=n||this._zoomScale;var i=this._getMinimumContentOffset(n),o=this._getMaximumContentOffset(n),s=this._calcContentSize(n),l=void 0,h=void 0;e?"auto"==this._scrollBounce?(l=this._containerWidth<s.width,h=this._containerHeight<s.height):l=h="off"!=this._scrollBounce:l=h=!1;var r=void 0,c=void 0;return r=l?a(i.x,t.x,o.x,4/n):Math.min(Math.max(t.x,i.x),o.x),c=h?a(i.y,t.y,o.y,4/n):Math.min(Math.max(t.y,i.y),o.y),{x:r,y:c}}},{key:"_handlePan",value:function(t){if(!(null!=this._gestureDelegate.handlePan&&this._gestureDelegate.handlePan(t)||this._pinchStartZoomScale))if("panstart"==t.type)this._panStartOffset={x:this._contentOffset.x,y:this._contentOffset.y};else if("panmove"==t.type){var e=this._limitContentOffset({x:this._panStartOffset.x-t.deltaX,y:this._panStartOffset.y-t.deltaY},!0);this._contentOffset.x=e.x,this._contentOffset.y=e.y,this.layout()}else if("panend"==t.type||"pancancel"==t.type){this._panStartOffset=null;var n=this._getMinimumContentOffset(),i=this._getMaximumContentOffset();(this._contentOffset.x<n.x||i.x<this._contentOffset.x||this._contentOffset.y<n.y||i.y<this._contentOffset.y)&&this.setContentOffset({x:Math.min(Math.max(this._contentOffset.x,n.x),i.x),y:Math.min(Math.max(this._contentOffset.y,n.y),i.y)},!0)}}},{key:"_limitZoomScale",value:function(t,e){return e?a(this._minimumZoomScale,t,this._maximumZoomScale,4):Math.min(Math.max(this._minimumZoomScale,t),this._maximumZoomScale)}},{key:"_handleMouseWheel",value:function(t){var e=this.globalToContent({x:t.pageX,y:t.pageY});t.deltaY<0?this.zoomToPoint(e,this._limitZoomScale(this._zoomScale*this._wheelZoomScale),!1):0<t.deltaY&&this.zoomToPoint(e,this._limitZoomScale(this._zoomScale/this._wheelZoomScale),!1)}},{key:"_handlePinch",value:function(t){if(null==this._gestureDelegate.handlePinch||!this._gestureDelegate.handlePinch(t))if("pinchstart"==t.type)this._pinchStartZoomScale=this._zoomScale;else if("pinchmove"==t.type){var e=this._limitZoomScale(this._pinchStartZoomScale*t.scale,!0);this._lastPinchCenter=this.globalToContent(t.center),this.zoomToPoint(this._lastPinchCenter,e)}else"pinchend"!=t.type&&"pinchcancel"!=t.type||(this._zoomScale<this._minimumZoomScale?this.setContentOffsetAndZoomScale({x:0,y:0},this._minimumZoomScale,!0):this._maximumZoomScale<this._zoomScale&&this.zoomToPoint(this._lastPinchCenter,this._maximumZoomScale,!0),this._pinchStartZoomScale=null)}},{key:"zoomToPoint",value:function(t,e,n){var i=this._calcContentAdjust(this._zoomScale),o={x:(this._contentOffset.x-i.x)/this._zoomScale,y:(this._contentOffset.y-i.y)/this._zoomScale,width:this._containerWidth/this._zoomScale,height:this._containerHeight/this._zoomScale},a=this._zoomScale/e,s=t.x-o.x,l=t.y-o.y,h={x:t.x-s*a,y:t.y-l*a,width:o.width*a,height:o.height*a};this.zoomTo(h,n)}},{key:"zoomTo",value:function(t,e){var n=this._containerWidth/t.width,i=this._containerHeight/t.height,o=Math.min(n,i),a=this._limitContentOffset({x:t.x*o,y:t.y*o},!1,o);this.setContentOffsetAndZoomScale(a,o,e)}}]),t}();e.default=c}]).default;
//# sourceMappingURL=jscrollview.min.js.map